---
// Hero section with animated background
import jwt from 'jsonwebtoken';

const sessionCookie = Astro.cookies.get('session');
const isSignedIn = !!sessionCookie?.value;
---

<section class="relative overflow-hidden bg-white pt-20 pb-32 sm:pt-32 sm:pb-40">
	<!-- Animated background elements -->
	<div class="absolute inset-0 overflow-hidden">
		<div
			class="absolute -top-40 -right-40 w-80 h-80 bg-primary-100 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-blob"
		>
		</div>
		<div
			class="absolute -bottom-40 -left-40 w-80 h-80 bg-accent-100 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-blob animation-delay-2000"
		>
		</div>
		<div
			class="absolute top-1/2 left-1/2 w-80 h-80 bg-pink-100 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-blob animation-delay-4000"
		>
		</div>
	</div>

	<!-- Content -->
	<div class="relative mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
		<div class="mx-auto max-w-4xl text-center">
			<!-- Badge -->
			<div class="mb-8 flex justify-center">
				<span
					class="inline-flex items-center gap-2 rounded-full bg-primary-50 px-4 py-1.5 text-sm font-semibold text-primary-600 border border-primary-200"
				>
					<span class="relative flex h-2 w-2">
						<span
							class="animate-ping absolute inline-flex h-full w-full rounded-full bg-primary-400 opacity-75"
						></span>
						<span class="relative inline-flex rounded-full h-2 w-2 bg-primary-500"></span>
					</span>
					Now Open for Beta
				</span>
			</div>

			<!-- Main Headline -->
			<h1 class="text-5xl sm:text-6xl md:text-7xl font-bold tracking-tight text-slate-900 mb-6">
				Connect with
				<span class="gradient-text">Code 'Penpals'</span>
			</h1>

			<!-- Subheadline -->
			<p class="text-xl sm:text-2xl text-slate-600 mb-8 leading-relaxed max-w-3xl mx-auto">
				Connected by our ‚ù§Ô∏è for code, a shared vision and purpose.
			</p>

			<!-- CTA Buttons -->
			<div class="flex flex-col sm:flex-row items-center justify-center gap-4 mb-4">
				{
					!isSignedIn ? (
						<>
							<a
								href="/api/auth/login"
								class="btn-primary flex items-center gap-2"
								onclick="this.innerHTML='<svg class=\'w-5 h-5 animate-spin\' fill=\'none\' viewBox=\'0 0 24 24\'><circle class=\'opacity-25\' cx=\'12\' cy=\'12\' r=\'10\' stroke=\'currentColor\' stroke-width=\'4\'></circle><path class=\'opacity-75\' fill=\'currentColor\' d=\'M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\'></path></svg> Signing in...'; this.classList.add('pointer-events-none', 'opacity-75');"
							>
								<svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
									<path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z" />
								</svg>
								Sign in with GitHub
							</a>
							<a href="/#how-it-works" class="btn-secondary">
								{' '}
								Learn More{' '}
							</a>
						</>
					) : (
						<>
							<a href="/profile" class="btn-primary flex items-center gap-2">
								<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
									<path
										stroke-linecap="round"
										stroke-linejoin="round"
										stroke-width="2"
										d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"
									/>
								</svg>
								Go to My Profile
							</a>
							<a href="/#how-it-works" class="btn-secondary">
								{' '}
								Learn More{' '}
							</a>
						</>
					)
				}
			</div>

			<!-- Sign up note -->
			{
				!isSignedIn && (
					<p class="text-sm text-slate-500 mb-16">
						New to CodePals? Signing in with GitHub will create your account automatically.
					</p>
				)
			}

			<!-- Hero Image / Illustration -->
			<div class="relative mx-auto max-w-2xl">
				<div
					class="aspect-square rounded-2xl bg-gradient-to-br from-primary-50 to-accent-50 border border-slate-200 shadow-2xl overflow-hidden"
				>
					<!-- Handshake illustration -->
					<div class="w-full h-full flex items-center justify-center">
						<div class="text-6xl">ü§ù</div>
					</div>
				</div>

				<!-- Floating cards -->
				<div
					class="absolute -left-8 top-1/2 card-dark transform -translate-y-1/2 w-40 animate-float hidden md:block"
				>
					<div class="flex items-center gap-3">
						<div class="w-10 h-10 rounded-full bg-primary-500/20"></div>
						<div>
							<p class="text-xs text-slate-400">Community</p>
							<p class="text-lg font-bold text-white">Open</p>
						</div>
					</div>
				</div>

				<div
					class="absolute -right-8 bottom-1/4 card-dark transform w-40 animate-float hidden md:block"
					style="animation-delay: 1s;"
				>
					<div class="flex items-center gap-3">
						<div class="w-10 h-10 rounded-full bg-accent-500/20"></div>
						<div>
							<p class="text-xs text-slate-400">Status</p>
							<p class="text-lg font-bold text-white">Beta</p>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<style>
		@keyframes blob {
			0%,
			100% {
				transform: translate(0, 0) scale(1);
			}
			33% {
				transform: translate(30px, -50px) scale(1.1);
			}
			66% {
				transform: translate(-20px, 20px) scale(0.9);
			}
		}

		:global(.animate-blob) {
			animation: blob 7s infinite;
		}

		:global(.animation-delay-2000) {
			animation-delay: 2s;
		}

		:global(.animation-delay-4000) {
			animation-delay: 4s;
		}
	</style>
</section>
